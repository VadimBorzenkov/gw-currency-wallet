# gw-currency-wallet

gw-currency-wallet — это микросервис для управления кошельком и обмена валют, поддерживающий регистрацию и авторизацию пользователей, пополнение счета, вывод средств, получение курсов валют и их обмен. В качестве базы данных используется PostgreSQL. Для взаимодействия с внешним сервисом курсов валют используется gRPC. Микросервис также поддерживает контейнеризацию с использованием Docker и Docker Compose.

---

## Основные функции

-Регистрация и авторизация пользователей с использованием JWT.
-Хранение и управление балансом пользователя в различных валютах (USD, RUB, EUR).
-Пополнение и вывод средств.
-Получение и кэширование курсов валют через gRPC.
-Обмен валют с автоматическим обновлением баланса.
-Поддержка RESTful API.

---

## Стек технологий

- **Go**: язык программирования для разработки высокопроизводительных приложений.
- **Fiber**: HTTP-фреймворк для разработки REST API.
- **gRPC**: протокол удаленного вызова процедур.
- **PostgreSQL**: база данных для хранения курсов валют.
- **JWT**: аутентификация и авторизация.
- **Docker**: контейнеризация приложений.
- **Docker Compose**: оркестрация контейнеров.
- **Logrus**: логирование.


---

## Установка и запуск

### Клонирование репозитория
1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/VadimBorzenkov/gw-currency-wallet.git
   cd gw-currency-wallet

2. Скопируйте файл конфигурации:
    ````bash
    cp example.env .env

3. Настройте файл .env:
    -DB_HOST: адрес базы данных (например, localhost или db при использовании Docker).
    -DB_USER, DB_PASSWORD, DB_NAME: учетные данные PostgreSQL.
    -LOG_LEVEL: уровень логирования (debug, info, warn, error).
    -LOG_FORMAT: формат логов (text или json).


### Создание ключей для JWT
1. Создайте директорию для хранения ключей:
    ````bash
    mkdir -p certs

2. Сгенерируйте приватный и публичный ключи с помощью OpenSSL:
    ````bash
    openssl genpkey -algorithm RSA -out certs/jwt-private.pem -pkeyopt rsa_keygen_bits:2048
    openssl rsa -in certs/jwt-private.pem -pubout -out certs/jwt-public.pem


### Запуск через Docker
1. Убедитесь, что переменная DB_HOST установлена как db в .env.

2. Запустите сервисы:
    ````bash
    docker-compose up --build
    
3. Проверьте, что контейнеры запущены:
    ````bash
    docker ps

### Локальный запуск
1. Установите зависимости:
    ````bash
    go mod tidy

2. Запустите PostgreSQL локально или измените DB_HOST в .env на localhost.

3. Запустите приложение:
    ```bash
    Копировать код
    go run ./cmd/main.go

4. Приложение запустится на порту 50051 (или указанном в .env).